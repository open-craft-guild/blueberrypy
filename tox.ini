[tox]
envlist = py27,py33,py34,py35,py36

[base]
deps = -rrequirements.txt
    nose
    nose-testconfig
    flexmock
    lazr.smtptest
    coverage
    openstack.nose-plugin
    pytest

[testenv]
install_command = pip install {opts} {packages}
deps = {[base]deps}
passenv = BLUEBERRYPY_CONFIG
changedir = {envdir}
commands = {envbindir}/nosetests --config={toxinidir}/setup.cfg --tc-file={toxinidir}/setup.cfg {envsitepackagesdir}/blueberrypy/tests/ {posargs}

# Reenable when this is merged
# https://github.com/geoalchemy/geoalchemy2/pull/79
[testenv:pypy]
deps = {[base]deps}
       psycopg2cffi

[testenv:py27]
install_command = pip install {opts} {packages}
deps = {[base]deps}
       mock
       hiredis
       MarkupSafe
       psycopg2

[testenv:py33]
deps = {[base]deps}
       hiredis
       MarkupSafe
       psycopg2

[testenv:py34]
deps = {[base]deps}
       hiredis
       MarkupSafe
       psycopg2

[testenv:py35]
deps = {[base]deps}
       hiredis
       MarkupSafe
       psycopg2

[testenv:py36]
deps = {[base]deps}
       aiosmtpd
       hiredis
       MarkupSafe
       psycopg2
